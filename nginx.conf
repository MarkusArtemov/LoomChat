http {
    upstream auth_upstream {
        server authservice1:8080;
        server authservice2:8080;
    }

    upstream chat_upstream {
        server chatservice1:8080;
        server chatservice2:8080;
    }

    server {
        listen 80;

        # Auth
        location /auth/ {
            # Alle Requests an /auth/... weiterleiten an AuthService
            proxy_pass http://auth_upstream/;
        }

        # Chat - REST
        location /chat/ {
            # Alle Requests an /chat/... weiterleiten an ChatService
            proxy_pass http://chat_upstream/;
        }

        # Chat - SignalR-Hub (falls du /chatHub brauchst)
        # Beispiel: location /chatHub/ => proxy_pass http://chat_upstream/chatHub/;
        # Beachte: Pfad-Ende mit / ist oft wichtig, damit die Routen richtig gemappt werden.
        location /chatHub/ {
            proxy_pass http://chat_upstream/chatHub/;
            # WebSockets und andere Upgrades durchleiten
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
        }
    }
}
